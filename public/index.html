<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fiscabot - DETRAN-AM</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f6f8; margin: 0; }
    .chat-container {
      width: 100%; max-width: 500px; margin: 40px auto; background: white;
      border-radius: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); padding: 20px;
    }
    .bot { background: #005baa; color: white; padding: 10px; border-radius: 8px; margin: 5px 0; }
    .user { background: #e5e5ea; color: black; padding: 10px; border-radius: 8px; margin: 5px 0; text-align: right; }
    input, button { padding: 10px; border-radius: 8px; border: 1px solid #ccc; margin-top: 10px; width: 70%; }
    button { background: #005baa; color: white; cursor: pointer; width: 25%; }
    .input-row { display: flex; justify-content: space-between; }
  </style>
</head>
<body>
  <div class="chat-container">
    <div id="chat"></div>
    <div class="input-row">
      <input id="userInput" placeholder="Digite sua resposta..." />
      <button onclick="sendMessage()">Enviar</button>
    </div>
  </div>

  <script>
    const chat = document.getElementById("chat");
    let etapa = "menu"; // controla o fluxo
    let denuncia = { tipo: "", local: "", inicio: "", fim: "", obs: "" };

    function addMessage(text, sender) {
      const msg = document.createElement("div");
      msg.className = sender;
      msg.textContent = text;
      chat.appendChild(msg);
      chat.scrollTop = chat.scrollHeight;
    }

    // Mensagem inicial
    addMessage("üëÆ‚Äç‚ôÇÔ∏è Ol√°! Eu sou o Fiscabot, assistente da fiscaliza√ß√£o do DETRAN-AM.", "bot");
    mostrarMenu();

    function mostrarMenu() {
      etapa = "menu";
      addMessage("Escolha uma op√ß√£o:\n1 - Den√∫ncia de Rolezinho\n2 - Den√∫ncia de Adega\n3 - Den√∫ncia de Estacionamento Irregular\n4 - Encerrar conversa", "bot");
    }

    function sendMessage() {
      const input = document.getElementById("userInput");
      const text = input.value.trim();
      if (!text) return;
      addMessage(text, "user");
      input.value = "";

      if (etapa === "menu") {
        if (text === "1") { denuncia.tipo = "Rolezinho"; etapa = "local"; addMessage("üìç Informe o local do Rolezinho:", "bot"); }
        else if (text === "2") { denuncia.tipo = "Adega"; etapa = "local"; addMessage("üìç Informe o endere√ßo da Adega:", "bot"); }
        else if (text === "3") { denuncia.tipo = "Estacionamento"; etapa = "local"; addMessage("üìç Informe o local do estacionamento irregular:", "bot"); }
        else if (text === "4") { addMessage("‚úÖ Obrigado! Conversa encerrada. üö¶", "bot"); }
        else { addMessage("Op√ß√£o inv√°lida. Escolha 1, 2, 3 ou 4.", "bot"); }
      }
      else if (etapa === "local") {
        denuncia.local = text;
        etapa = "inicio";
        addMessage("‚è∞ Informe a hora de in√≠cio (ex: 20:00):", "bot");
      }
      else if (etapa === "inicio") {
        denuncia.inicio = text;
        etapa = "fim";
        addMessage("‚è∞ Informe a hora de fim (ex: 23:30):", "bot");
      }
      else if (etapa === "fim") {
        denuncia.fim = text;
        etapa = "obs";
        addMessage("üìù Alguma observa√ß√£o adicional?", "bot");
      }
      else if (etapa === "obs") {
        denuncia.obs = text;
        etapa = "final";
        addMessage(`‚úÖ Obrigado. Sua den√∫ncia foi registrada:\nTipo: ${denuncia.tipo}\nLocal: ${denuncia.local}\nIn√≠cio: ${denuncia.inicio}\nFim: ${denuncia.fim}\nObs: ${denuncia.obs}\n\nSer√° encaminhada √† equipe de fiscaliza√ß√£o do DETRAN-AM, conforme o CTB e o MBFT.`, "bot");
        mostrarMenu(); // volta ao menu
      }
    }
  </script>
</body>
</html>
